<!DOCTYPE html>
<html>
<head>
<style type="text/css">
  .loginStatus {text-align:center;}
    #updateStatus_form{border:1px solid #999; -webkit-box-shadow: 0px 0px 6px #CCC; background-color:#FFF; position: absolute; top:400px; left:25%; margin-left:-125px; padding:10px; border-radius:4px;}
</style>
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1,user-scalable=no">
	<link rel="stylesheet" href="/style.css">
	<link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.0/themes/base/jquery-ui.css">
</head>
<body>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.0/jquery-ui.min.js"></script> 
  <script src="/jquery.qrcode.min.js"></script>
<header class="header">
	<section class="headerContainer">
		<a href="http://a2p3.net"><img class="headerLogo" alt="A2P3" src="/images/a2p3_logo.png" border="0"></a>
		<span class="mainTitle">Law Society</span>
		<div class="mainTitleText">Welcome to the Member Portal</div>
		<div class="loginStatus">
		  <a href="/logout" id="logout" class="genericSmallButton">Logout</a>
		</div>
		<div style="" class="di">
	      <br>
		  <span id="directedIdentifier"></span>
		  <a class="otherLinks" href="" id="showDI">show DI</a>
		  <a class="otherLinks" href="" id="hideDI">hide DI</a>
		</div>
	
	</section>
</header>

<section class="mainContent">
	<div class="mainContentWrap">
		<div id="profileSection" class="genericSection">
			<a id="accountDelete" class="genericButton" style="float:right;top:0px:right:0px;" href="">Delete Account</a>
			<div id="enrollmentDescriptionSection" style="top:0px; right: 50%; float:right; width:50%;">
		      <p>If this were a real enrollment process, the name, DOB, address, email and membership number and any other shared identity idenity would be confirmed to match information in the existing database. When the user confirms, the A2P3 Directed Identifier would be linked to the existing database and the user would be able authorize apps to access their their membership status and membership number.</p>
	      	</div>

			<div class="categoryTitle">Profile</div>
			
			<table id="profileTable" class=""> </table>

		</div>
		<div id="membershipSection" class="genericSection">
			<table id="membershipTable"></table>
		</div>
		
    
    <div id="enrollmentSection" class="genericSection">
      <div class="categoryTitle">Membership Verification
      </div>
      
      <p>Please set a ficticious value to simulate a membership number.</p>
      <div class="formItemWrap">
        <span class="genericLabel" style="text-align: left;">Law Society Membership Number</span>
          <input type="text" size="8" id="membershipNumber_input"
          placeholder="XXX-XXX" class="textMembershipNumber" name="number">
      </div>
    </div>

    <div id="statusSection" class="genericSection">
      <div class="categoryTitle">Membership Status
        <p>
          <div id="membershipStatus"></div>
        </p>
      </div>
      <a id="changeStatus" class="genericButton" href="">Change Status</a>
	  
	  <br><br>
    </div>


		<div id="TOS" class="genericSection">
			<div class="categoryTitle">Terms of Service</div>
			<!-- make the a scrollable text box -->
			<p>
			  Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
			</p>
			<p align="right">
				 <a href="/logout" id="cancel" class="genericButton">Cancel</a>
				<a class="genericButton" href="" id="agreeTOS">I Agree</a>
			</p>
		</div>
	</div>

    <div id="updateStatus_form">
      <div class="genericTitle">Update Membership Status</div>
        <form id="updateStatus_input">
          <div style="padding-left: 10px;">
	          <input type="radio" name="status" value="PRACTISING" id="PRACTISING"><label for="PRACTISING"> PRACTISING</label><br>
	          <input type="radio" name="status" value="NON-PRACTISING" id="NON-PRACTISING"><label for="NON-PRACTISING"> NON-PRACTISING</label><br>
	          <input type="radio" name="status" value="RETIRED" id="RETIRED"><label for="RETIRED"> RETIRED</label><br>
		  </div>
            <p><input class="genericButton" id="updateStatusCancel" type="button" value="CANCEL">
                <input class="genericButton" id="updateStatusSubmit" type="button" value="UPDATE">
              </p>
        </form>
    </div>

    <div title="Confirm User Removal" name="userDeleteDialogConfirm"
    	id="userDeleteDialogConfirm">

      <div style="margin-top: 8px;" id="confirmUserDelete"
      name="confirmUserDelete" class="dashboardCategoryTitleDetail">
        Are you sure you wish to remove this user?
      </div>
    </div>

</section>


<script type="text/javascript">

function onReady() {

  $('#logout').hide()
  $('#cancel').hide()
  $('#TOS').hide()
  $('#profileSection').hide()
  $('#enrollmentSection').hide()
  $('#hideDI').hide()
  $('#directedIdentifier').hide()
  $('#removeAccount').hide()
  $('#enrollmentSection').hide()
  $('#enrollmentDescriptionSection').hide()
  $('#statusSection').hide()
  $('#updateStatus_form').hide()
  $('#userDeleteDialogConfirm').hide()

  $('#hideDI').click( function () {
    $('#directedIdentifier').hide()
    $('#hideDI').hide()
    $('#showDI').show()
    return false
  })

  $('#showDI').click( function () {
    $('#showDI').hide()
    $('#hideDI').show()
    $('#directedIdentifier').show()
    return false
  })

  $('#showDI').click( function () {
    $('#showDI').hide()
    $('#hideDI').show()
    $('#directedIdentifier').show()
    return false
  })


  $('#accountDelete').click(function() {

    $("#userDeleteDialogConfirm").dialog({
      width : 400,
      buttons : {
        "No" : function() {
          $(this).dialog("close");
        },

        "Yes" : function() {
          window.location = "/lawyer/account/delete";
        }
      }
    });

    return false
  })

  var status = null;

  function drawProfile( profile ) {
    if (!profile) return window.location = '/'
    // console.log( profile )
    $('#directedIdentifier').text( profile.di )

// GREG: would like the profile page to look like it is in the mockups. No labels. Lighter grey to show sections.

    $.each( profile, function ( item, value ) {
      if (item == 'status' || item == 'di') return
      if (item == 'photo') {
        $('#profileTable').append('<tr><td class="genericLabel">' + item + ':</td><td><img class="photoImage" src="' + value + '"></td></tr>')
      } else {
        $('#profileTable').append('<tr><td class="genericLabel">' + item + ':</td><td class="">' + value + '</td></tr>')
      }
    })
    $('#profileSection').show()
    if ( !profile.status ) {  // need to enroll and agree to TOS
      $('#membershipNumber_input').val( Math.floor( Math.random() * 899 + 100 ) + '-' + Math.floor( Math.random() * 899 + 100 ) )
      $('#enrollmentDescriptionSection').show()
      $('#enrollmentSection').show()
      $('#cancel').show()
      $('#TOS').show()
      $('#accountDelete').hide()
    } else {
      status = profile.status
      $('#membershipStatus').text( profile.status )
      $('#statusSection').show()
      $('#removeAccount').show()
      $('#logout').show()
    }
  }

  $.ajaxSetup(
    { type: 'POST'
    , headers: { "cache-control": "no-cache" }
    } )

  $('#agreeTOS').click( function () {
    $.post( '/lawyer/agree/tos'
          , { number: $('#membershipNumber_input').val() }
          , function ( data, status ) { window.location = '/lawyer'}
          )
    return false
  })

  $('#changeStatus').click( function () {
    $('#'+status).attr('checked', 'checked')
    $('#updateStatus_form').show()
    return false
  })

  $('#updateStatusCancel').click( function () {
    $('#updateStatus_form').hide()
    return false
  })

  $('#updateStatusSubmit').click( function () {
    $.post( '/lawyer/status'
          , { status: $("input:radio[name='status']:checked").val() }
          , function ( data, status ) { window.location = '/lawyer' }
          )
    return false
  })


  // see if we have a profile to show on a reload
  $.post( '/lawyer/profile', function ( data, status ) {
    // console.log( '/profile ->', data )
    if (status == "success" && !data.error && data.result ) {
      drawProfile( data.result )
    }
    else
      window.location = '/'
  })

} // onReady

$(document).ready(onReady)

</script>

</body>
</html>